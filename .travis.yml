language: c
compiler: gcc clang
before_install:
  - pip install --user cpp-coveralls
  - mkdir -p $HOME/protobuf && pushd $HOME/protobuf
        && curl -LO 'https://github.com/google/protobuf/releases/download/v3.4.0/protoc-3.4.0-linux-x86_64.zip'
        && unzip protoc-3.4.0-linux-x86_64.zip
        && popd

script:
  - bash build.sh run_gcc_tests clang
  - bash build.sh run_gcc_tests

after_success:
  - pip install --user cpp-coveralls
  - coveralls --exclude gpslib/src/tests/ --exclude logsrv/tests/  --exclude tests/ --gcov-options '\-lp'
